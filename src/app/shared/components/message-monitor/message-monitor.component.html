<nb-card size="large">
  <nb-card-header class="header-details">
    Messages
    <nb-select class="right" [(selected)]="mode" size="tiny">
      <nb-option *ngFor="let mode of this.modes" [value]="mode">{{mode}}</nb-option>
    </nb-select>
  </nb-card-header>
  <nb-card-body style="height:100%">
    <div [ngSwitch]="mode">
      <div *ngSwitchCase="'table'">
        <table>
          <tr>
            <th>name</th>
            <th>value</th>
            <th>time</th>
            <th>subtopic</th>
            <th>channel</th>
            <th>publisher</th>
            <th>protocol</th>
          </tr>
          <tr *ngFor="let message of messages">
            <td>{{message.name}}</td>
            <td>{{message | messageValue}}</td>
            <td>{{message.time*1000 | date:'medium'}}</td>
            <td>{{message.subtopic}}</td>
            <td>{{message.channel}}</td>
            <td>{{message.publisher}}</td>
            <td>{{message.protocol}}</td>
          </tr>
        </table>
      </div>
      <div *ngSwitchCase="'json'">
        <pre  *ngFor="let message of messages">{{ message | json }}</pre>
      </div>
      <div *ngSwitchCase="'chart'" style="height:100%">
        <div *ngIf="messages.length != 0">
          <ngx-chart [msgDatasets]="msgDatasets"></ngx-chart>
        </div>
      </div>
    </div>
    <div *ngIf="messages.length == 0" class="no-msg">
      No messages to display
    </div>
  </nb-card-body>
  <nb-card-footer>
    <div class="row form-row">
      <div class="col-1 info-details">
        Channels:
      </div>
      <div class="col-4">
        <nb-select fullWidth [(selected)]="chanID" size="tiny" (selectedChange)="getChannelMessages()">
          <nb-option *ngFor="let ch of channels" [value]="ch.id">{{ch.id}}</nb-option>
        </nb-select>
      </div>
      <div class="col-1 info-details">
        Subtopic:
      </div>
      <div class="col-2">
        <input nbInput fullWidth fieldSize="tiny"
               [(ngModel)]='filters.subtopic'>
      </div>
      <div class="col-1 info-details">
        Time:
      </div>
      <div class="col-2">
        <input nbInput placeholder="Pick up date" [nbDatepicker]="rangepicker" fullWidth fieldSize="tiny">
        <nb-rangepicker #rangepicker (rangeChange)="getRangeDate($event)"></nb-rangepicker>
      </div>
    </div>
    <div class="row form-row">
      <div class="col-1 info-details">
        Publisher:
      </div>
      <div class="col-4">
        <nb-select fullWidth [(selected)]="filters.publisher" size="tiny" (selectedChange)="getChannelMessages()">
          <nb-option *ngFor="let pub of publishers" [value]="pub.id">{{pub.id}}</nb-option>
        </nb-select>
      </div>
      <div class="col-1 info-details">
        Name:
      </div>
      <div class="col-2">
        <input nbInput fullWidth fieldSize="tiny"
               [(ngModel)]='filters.name'>
      </div>
      <div class="col-1 info-details">
        Value:
      </div>
      <div class="col-2">
        <input nbInput fullWidth fieldSize="tiny"
               [(ngModel)]='filters.value'>
      </div>
    </div>
    <div class="right">
      <button nbButton size="tiny" class="button-green"
              (click)="getChannelMessages()">
        Filter
      </button>
    </div>
  </nb-card-footer>
</nb-card>
